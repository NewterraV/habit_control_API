# API сервис по контролю привычек
Сервис создан для закрепления пользователем привычек.


## Установка
### Основные зависимости:
    python = "^3.11"
    django = "^4.2.6"
    psycopg2-binary = "^2.9.9"
    django-rest-framework = "^0.1.0"
    python-dotenv = "^1.0.0"
    django-cors-headers = "^4.2.0"
    drf-yasg = "^1.21.7"
    redis = "^5.0.1"
    djangorestframework-simplejwt = "^5.3.0"
    celery = "^5.3.4"
    django-celery-beat = "^2.5.0"
    requests = "^2.31.0"
    django-filter = "^23.3"

#### Дополнительные зависимости (группа ```dev```):
    coverage = "^7.3.2"
    flake8 = "^6.1.0"

#### Управление через менеджер зависимостей ```Poetry```:
```sh
$ pip install poetry
```
Установка зависимостей:
```sh
$ poetry install
```

### Базовая настройка
Выполнить настройку в файле ```.env```

Запуск Worker
```shell
$ celery -A config worker --loglevel INFO
```

Запуск периодических задач
```sh
$ celery -A config beat -l info 
  --scheduler django_celery_beat.schedulers:DatabaseScheduler
```

## Описание основной логики работы
##### Документация с описанием эндпоинтов
    http://host/redoc/
    http://host/swagger/

Сервис позволяет создавать, редактировать, удалять и просматривать привычки.
Возможно полное взаимодействие со своими привычками, и частичное(просмотр) с 
опубликованными другими пользователями.

Для каждой привычки создается периодическая задача с интервалом выполнения от 
одного дня до недели. В указанное пользователем время автоматически
отправляется уведомление в телеграм аккаунт.

При создании пользователя, пользователь должен указать свой телеграм аккаунт,
после чего необходимо отправить сообщение `/start` боту. Бот в ответ присылает
сообщение с подтверждением регистрации аккаунта и после этого может слать 
уведомления пользователю.

Сервис позволяет создавать полезные и приятные
привычки. Если привычка приятная, то она не может
иметь каких либо вознаграждений. Если привычка
полезная, то вознаграждение должно быть выбрано обязательно, но только либо приятная привычка, либо
текстовое описание. При обновлении привычки, пользователь имеет возможность сменить привычку с
 приятной на полезную и обратно. При смене полезной на приятную, автоматически убирается вознаграждение
и создаётся новая модель с ссылкой на привычку. При
смене с приятной на полезную, во всех связанных полезных привычках в вознаграждении проставляется 
null.

